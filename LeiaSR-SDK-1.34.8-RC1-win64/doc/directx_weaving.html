<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LeiaSR SDK: Getting Started - C++/DirectX Weaving</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="extrastyle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="sr-logo.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LeiaSR SDK<span id="projectnumber">&#160;3e4093ae v1.34.8.37806 2025-10-23T12:33:42Z</span>
   </div>
   <div id="projectbrief">Stable</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Getting Started - C++/DirectX Weaving </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md_C__GitLabRunner_builds_fe33718a_0_simulatedreality_simulatedreality_modules_srDirectX_documentation_doxygen_pages_directx_weaving"></a></p>
<h1><a class="anchor" id="build"></a>
Build and run C++/DirectX example</h1>
<ul>
<li>Navigate to the install directory. Then go to the examples directory and execute the following commands as administrator <div class="fragment"><div class="line">cd examples/external/example_directX_weaving</div>
<div class="line">mkdir build </div>
<div class="line">cd  build</div>
<div class="line">cmake -G &quot;Visual Studio 15 2017 Win64&quot; ..</div>
</div><!-- fragment --> <b>Note: </b><ul>
<li>To run these command as administrator, open the Start menu, and scroll to "Windows PowerShell", from the right-click menu, select "Run as administrator". <img src="RunAsAdmin.png" alt="" class="inline" title="Running Windows PowerShell as Administrator"/></li>
<li>Please take into account that you should select the correct input for <b> -G </b> parameter based on the installed Visual Studio on your system.</li>
</ul>
</li>
<li>Open Visual Studio as Administrator. To do so, open the Start menu, and scroll to Visual Studio, then from the right-click or context menu of Visual Studio, select More &gt; Run as administrator. When Visual Studio starts, (Administrator) appears after the product name in the title bar.</li>
<li>Then open example_directX_weaving.sln in Visual Studio. Build example_directX_weaving project and run it.</li>
<li>If the Eyetracker application is running a cube object is expected to be displayed in 3D. If the Eyetracker application is not running the default eye positions will be used. These are identical for the left and right perspective such that a stereo image with zero disparity will be presented. You will only be able to look around the cube in <a class="el" href="namespaceSR.html" title="Namespace containing all C++ Simulated Reality classes.">SR</a> if the Eyetracker application is running in the background.</li>
</ul>
<h1><a class="anchor" id="example"></a>
C++/DirectX example</h1>
<p ><b>Note:</b></p><ul>
<li>Weaving in our context is the process that for every subpixel (red,green,blue) selects which view (left,right) should be shown. Every subpixel can only be seen from certain angles, so for every subpixel it is determined whether the right eye or left eye of the user is closest to the direction in which this subpixel can be seen.</li>
</ul>
<p >The expected behavior of the example is to display a cube object in 3D. This requires the eyetracker class.</p><ul>
<li>Class <code>SREyePairListener</code> is the listener that accept eye pair coordinates from the <a class="el" href="classSR_1_1EyeTracker.html">EyeTracker</a> class.</li>
<li>To start streaming eye positions <a class="el" href="classSR_1_1SRContext.html">SRContext</a> has to be initialized: <div class="fragment"><div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span> </div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> startTime = (double)GetTickCount64() / 1000.0;</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span> </div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>    <span class="comment">// Create SR context.</span></div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>    <span class="keywordflow">while</span> (g_srContext == <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>    {</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>        <span class="keywordflow">try</span></div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>        {</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>            g_srContext = <a class="code hl_function" href="classSR_1_1SRContext.html#ae3bbf70838bf6946a47f2be067621887">SR::SRContext::create</a>();</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>        }</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>        <span class="keywordflow">catch</span> (<a class="code hl_class" href="classSR_1_1ServerNotAvailableException.html">SR::ServerNotAvailableException</a> e)</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>        {</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>            <span class="comment">// Ignore errors because SR may be starting-up.</span></div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>        }</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span> </div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Waiting for context&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span> </div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>        <span class="comment">// Wait a bit.</span></div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>        Sleep(100);</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span> </div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>        <span class="comment">// Abort if we exceed the maximum allowed time.</span></div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>        <span class="keywordtype">double</span> curTime = (double)GetTickCount64() / 1000.0;</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>        <span class="keywordflow">if</span> ((curTime - startTime) &gt; maxTime)</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>    }</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span> </div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>    <span class="comment">// Wait for display to be ready.</span></div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>    <span class="keywordtype">bool</span> displayReady = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>    <span class="keywordflow">while</span> (g_srContext &amp;&amp; !displayReady)</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>    {</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>        <span class="comment">// Attempt to get display.</span></div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>        <a class="code hl_class" href="classSR_1_1Display.html">SR::Display</a>* display = <a class="code hl_function" href="classSR_1_1Display.html#a4dcdcc6f20eafd45f98d34890c792bd0">SR::Display::create</a>(*g_srContext);</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>        <span class="keywordflow">if</span> (display != <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>        {</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>            <span class="comment">// Get the display location, and when it is valid, the device is ready.</span></div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>            <a class="code hl_union" href="unionSR__recti.html">SR_recti</a> displayLocation = display-&gt;<a class="code hl_function" href="classSR_1_1Display.html#a34c49b6aaeb97c4d0d07c629d1dd2e13">getLocation</a>();</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>            int64_t width = displayLocation.<a class="code hl_variable" href="unionSR__recti.html#aa0d00bd2c5340f41d0174e1062f11e39">right</a> - displayLocation.<a class="code hl_variable" href="unionSR__recti.html#adfa344c676fdd1fbb85563a4df011214">left</a>;</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>            int64_t height = displayLocation.<a class="code hl_variable" href="unionSR__recti.html#aba1069d7251abd8c189f63837d1d1619">bottom</a> - displayLocation.<a class="code hl_variable" href="unionSR__recti.html#a90bb1d7d723752dd3df29ab71c627f83">top</a>;</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>            <span class="keywordflow">if</span> ((width != 0) &amp;&amp; (height != 0))</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>            {</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>                displayReady = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>            }</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>        }</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span> </div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Waiting for display&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span> </div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>        <span class="comment">// Wait a bit.</span></div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>        Sleep(100);</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span> </div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>        <span class="comment">// Abort if we exceed the maximum allowed time.</span></div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>        <span class="keywordtype">double</span> curTime = (double)GetTickCount64() / 1000.0;</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>        <span class="keywordflow">if</span> ((curTime - startTime) &gt; maxTime)</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>    }</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span> </div>
<div class="ttc" id="aclassSR_1_1Display_html"><div class="ttname"><a href="classSR_1_1Display.html">SR::Display</a></div><div class="ttdoc">Class of WorldObject representing the SR display in real space.</div><div class="ttdef"><b>Definition:</b> display.h:31</div></div>
<div class="ttc" id="aclassSR_1_1Display_html_a34c49b6aaeb97c4d0d07c629d1dd2e13"><div class="ttname"><a href="classSR_1_1Display.html#a34c49b6aaeb97c4d0d07c629d1dd2e13">SR::Display::getLocation</a></div><div class="ttdeci">virtual SR_recti getLocation()=0</div><div class="ttdoc">Finds the SR monitor and return it's location in the display configuration.</div></div>
<div class="ttc" id="aclassSR_1_1Display_html_a4dcdcc6f20eafd45f98d34890c792bd0"><div class="ttname"><a href="classSR_1_1Display.html#a4dcdcc6f20eafd45f98d34890c792bd0">SR::Display::create</a></div><div class="ttdeci">static Display * create(SRContext &amp;context)</div><div class="ttdoc">Creates an instance of a Display class.</div></div>
<div class="ttc" id="aclassSR_1_1SRContext_html_ae3bbf70838bf6946a47f2be067621887"><div class="ttname"><a href="classSR_1_1SRContext.html#ae3bbf70838bf6946a47f2be067621887">SR::SRContext::create</a></div><div class="ttdeci">static SRContext * create(NetworkMode mode=NetworkMode::NonBlockingClientMode)</div><div class="ttdoc">create new SRContext instance</div></div>
<div class="ttc" id="aclassSR_1_1ServerNotAvailableException_html"><div class="ttname"><a href="classSR_1_1ServerNotAvailableException.html">SR::ServerNotAvailableException</a></div><div class="ttdoc">Class of Exception which indicates that a SR Service was not available to connect with.</div><div class="ttdef"><b>Definition:</b> exception.h:96</div></div>
<div class="ttc" id="aunionSR__recti_html"><div class="ttname"><a href="unionSR__recti.html">SR_recti</a></div><div class="ttdoc">C-compatible integer rectangle representation.</div><div class="ttdef"><b>Definition:</b> types.h:107</div></div>
<div class="ttc" id="aunionSR__recti_html_a90bb1d7d723752dd3df29ab71c627f83"><div class="ttname"><a href="unionSR__recti.html#a90bb1d7d723752dd3df29ab71c627f83">SR_recti::top</a></div><div class="ttdeci">int64_t top</div><div class="ttdoc">Top-most border in the rectangle.</div><div class="ttdef"><b>Definition:</b> types.h:115</div></div>
<div class="ttc" id="aunionSR__recti_html_aa0d00bd2c5340f41d0174e1062f11e39"><div class="ttname"><a href="unionSR__recti.html#aa0d00bd2c5340f41d0174e1062f11e39">SR_recti::right</a></div><div class="ttdeci">int64_t right</div><div class="ttdoc">Right-most border in the rectangle.</div><div class="ttdef"><b>Definition:</b> types.h:116</div></div>
<div class="ttc" id="aunionSR__recti_html_aba1069d7251abd8c189f63837d1d1619"><div class="ttname"><a href="unionSR__recti.html#aba1069d7251abd8c189f63837d1d1619">SR_recti::bottom</a></div><div class="ttdeci">int64_t bottom</div><div class="ttdoc">Bottom-most border in the rectangle.</div><div class="ttdef"><b>Definition:</b> types.h:117</div></div>
<div class="ttc" id="aunionSR__recti_html_adfa344c676fdd1fbb85563a4df011214"><div class="ttname"><a href="unionSR__recti.html#adfa344c676fdd1fbb85563a4df011214">SR_recti::left</a></div><div class="ttdeci">int64_t left</div><div class="ttdoc">Left-most border in the rectangle.</div><div class="ttdef"><b>Definition:</b> types.h:114</div></div>
</div><!-- fragment --></li>
<li>The DirectX library is used to draw objects. For the extensive tutorial on how to visualize objects in DirectX follow the <a href="http://www.directxtutorial.com/">link</a>. In this guide we briefly point out that DirectX objects are represented by a buffer of vertices (surface of each object can be represented by a set of triangles. Each of these triangles is represented by three vertices with a 3D position and color). In this example a cube is drawn using 12 triangles.</li>
<li>Once the object is defined in the buffers it can be further visualized in a desired location and for a desired viewpoint. Those transformations are done in the <code>CalculateModelViewProjectionMatrix()</code> function. Rendering is done using the function <code>Render()</code>.</li>
<li>In order to visualize 3D object both left and right eye images have to be rendered. Therefore projection matrix is computed for the left and for the right eye: <div class="fragment"><div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span> </div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span>        <span class="comment">// Render cube into stereo view texture.</span></div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span> </div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>        <span class="comment">// Clear view texture to blue</span></div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>        <span class="keyword">const</span> FLOAT offscreenColor[4] = { GetSRGB(0.05f), GetSRGB(0.05f), GetSRGB(0.25f), 1.0f };</div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>        g_immediateContext-&gt;ClearRenderTargetView(g_viewTextureRTV, offscreenColor);</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>        g_immediateContext-&gt;ClearDepthStencilView(g_viewDepthTextureDSV, D3D11_CLEAR_DEPTH | D3D11_CLEAR_STENCIL, 1.0f, 0);</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span> </div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>        <span class="comment">// Set view texture as target.</span></div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span><span class="preprocessor">#if defined(USE_DEPRECATED_WEAVER)</span></div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span>        <span class="keywordflow">if</span> (!g_useDeprecatedFramebuffer || (g_demoMode == eDemoMode::StereoImage))</div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>        {</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span>            <span class="comment">// Use the app-provided view texture.</span></div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>            g_immediateContext-&gt;OMSetRenderTargets(1, &amp;g_viewTextureRTV, g_viewDepthTextureDSV);</div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>        }</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span>        {</div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>            <span class="comment">// Use the deprecated weaver-provided view texture.</span></div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>            ID3D11RenderTargetView* View = g_srWeaver-&gt;getFrameBuffer();</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>            g_immediateContext-&gt;ClearRenderTargetView(View, offscreenColor);</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span>            g_immediateContext-&gt;OMSetRenderTargets(1, &amp;View, g_viewDepthTextureDSV);</div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>        }</div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span>        g_immediateContext-&gt;OMSetRenderTargets(1, &amp;g_viewTextureRTV, g_viewDepthTextureDSV);</div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span> </div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span>        <span class="comment">// Set shaders and vertex input layout.</span></div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>        g_immediateContext-&gt;VSSetShader(g_vertexShader, <span class="keyword">nullptr</span>, 0);</div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>        g_immediateContext-&gt;PSSetShader(g_pixelShader, <span class="keyword">nullptr</span>, 0);</div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span>        g_immediateContext-&gt;IASetInputLayout(g_inputLayout);</div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span> </div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span>        <span class="comment">// Set vertex buffer (XYZ|RGB)</span></div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>        UINT stride = 6 * <span class="keyword">sizeof</span>(float);</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span>        UINT offset = 0;</div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span>        g_immediateContext-&gt;IASetVertexBuffers(0, 1, &amp;g_vertexBuffer, &amp;stride, &amp;offset);</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span> </div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>        <span class="comment">// Set index buffer.</span></div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>        g_immediateContext-&gt;IASetIndexBuffer(g_indexBuffer, DXGI_FORMAT_R32_UINT, 0);</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span> </div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span>        <span class="comment">// Set primitive topology</span></div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span>        g_immediateContext-&gt;IASetPrimitiveTopology(D3D11_PRIMITIVE_TOPOLOGY_TRIANGLELIST);</div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span> </div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span>        <span class="comment">// Render stereo views.</span></div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)</div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span>        {</div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span>            <span class="comment">// Set viewport to cover left or right of view texture size.</span></div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span>            D3D11_VIEWPORT viewport = {};</div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span>            viewport.TopLeftX = (FLOAT)(i * g_viewTextureWidth);</div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span>            viewport.TopLeftY = 0.0f;</div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span>            viewport.Width    = (FLOAT)g_viewTextureWidth;</div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span>            viewport.Height   = (FLOAT)g_viewTextureHeight;</div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span>            viewport.MinDepth = 0.0f;</div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span>            viewport.MaxDepth = 1.0f;</div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span>            g_immediateContext-&gt;RSSetViewports(1, &amp;viewport);</div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span> </div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span>            <span class="comment">// Update constant buffer.</span></div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span>            mat4f mvp = CalculateModelViewProjectionMatrix((i == 0) ? leftEye : rightEye, (<span class="keywordtype">float</span>)elapsedTime);</div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span>            g_immediateContext-&gt;UpdateSubresource(g_shaderConstantBuffer, 0, NULL, &amp;mvp, 0, 0);</div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span>            g_immediateContext-&gt;VSSetConstantBuffers(0, 1, &amp;g_shaderConstantBuffer);</div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span>            g_immediateContext-&gt;PSSetConstantBuffers(0, 1, &amp;g_shaderConstantBuffer);</div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span> </div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span>            <span class="comment">// Render.</span></div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span>            g_immediateContext-&gt;DrawIndexed(36, 0, 0);</div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span>        }</div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span> </div>
</div><!-- fragment --> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
